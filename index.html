<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Quantapus</title>
    <meta name="description" content="">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <header>
        <div class="logo-container">
            <img class="logo" src="images/logo.svg" alt="logo">
            <div class="quantapus-text">Quantapus</div>
        </div>
        <a class="cta" href="#"><button>Sign In</button></a>
    </header>

    <div class="problems-container" id="problems-container">
        <!-- Problems dynamically inserted here -->
    </div>

    <script>
        const BACKEND_URL = 'http://api.quantapus.com/problems';

        // Function to fetch problems from the backend
        async function fetchProblems() {
            try{
                console.log('Fetching problems from:', BACKEND_URL);
                const response = await fetch(BACKEND_URL);
                console.log('Response status:', response.status);

                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                const problems = await response.json();
                console.log('Problems received:', problems);
                renderProblems(problems);
                
            } catch (error) {
                console.error('Error fetching problems:', error);
                renderError('Failed to load problems. Please try again later.');
            }
        }

        // Function to render problems in the DOM
        function renderProblems(problems) {
        const problemsContainer = document.getElementById('problems-container');
        problemsContainer.innerHTML = ''; // Clear existing content

        if (!problems || problems.length === 0) {
            problemsContainer.innerHTML = '<p>No problems found.</p>';
            return;
        }

        problems.forEach(problem => {
            const problemDiv = document.createElement('div');
            problemDiv.className = 'problem';

            // Create problem left container
            const problemLeft = document.createElement('div');
            problemLeft.className = 'problem-left';

            // Create problem ID
            const problemId = document.createElement('span');
            problemId.className = 'problem-id';
            problemId.textContent = `#${problem.id}`; // Assuming problem.id is available

            // Create problem name
            const problemName = document.createElement('span');
            problemName.className = 'problem-name';
            problemName.textContent = problem.title || 'Untitled'; // Fallback for null title

            // Append problem ID and name to the problem left container
            problemLeft.appendChild(problemId);
            problemLeft.appendChild(problemName);

            // Create problem difficulty
            const problemDifficulty = document.createElement('span');
            problemDifficulty.className = `problem-difficulty ${problem.difficulty ? problem.difficulty.toLowerCase() : 'unknown'}`;
            problemDifficulty.textContent = problem.difficulty || 'Unknown'; // Fallback for null difficulty

            // Append problem left and difficulty to the problem div
            problemDiv.appendChild(problemLeft);
            problemDiv.appendChild(problemDifficulty);

            // Append the problem div to the container
            problemsContainer.appendChild(problemDiv);

            // Add click event listener to the problem div
            problemDiv.addEventListener('click', () => {
                // Navigate to the problem details page with the problem ID
                window.location.href = `problem.html?id=${problem.id}`;
            });
        });

}

        // Function to render an error message
        function renderError(message) {
            const problemsContainer = document.getElementById('problems-container');
            problemsContainer.innerHTML = `<p style="color: red;">${message}</p>`;
        }

        // Fetch and render problems when the page loads
        document.addEventListener('DOMContentLoaded', fetchProblems);
    </script>
</body>
</html>